# The pet trade of native species outside of their natural distributions within Australia is a biosecurity risk

Code for analysis from: 

Toomes, A., Stringham, O. C., Moncayo, S., Hill, K. G. W., Maher, J., Watters, F., Chekunov, S., García-Díaz, P., Mitchell, L., Ross, J. V., & Cassey, P. (2025). The pet trade of native species outside of their natural distributions within Australia is a biosecurity risk. Conservation Science and Practice, 7(1), e13298. https://doi.org/10.1111/csp2.13298

-   `01_data_gathering_cleaning` contains code that creates a dataset of advertisements that occur outside of a species native distribution within Australia. 
-   `02_range_bagging` contains code that implements the range bagging environmental suitability models, including downloading and cleaning occurence records, setting up cross validation, running and evaluating range bagging models. 
    -   `01-get-occurence-records` downloads occurrence records from GBIF
    -   `01a-get-established-ranges` obtains coordinates from known established ranges of species in the market
    -   `02a-proccess-occ-records` cleans coordinates and adds in coordinates from established ranges
    -   `03-setup-range-bagging` runs PCA for environmental predictor variables and generates a covariate matrix for each species globally (for training) and for Australia (for prediction).
    -   `04-range-bagging` runs tuning, training, evaluation range bagging for each species and selects best model to predict to Australia.
-   `03_data_summary` contains code that produces data summaries of numbers and figures used in the paper.

Below is the Methods section copied and pasted from the paper.

## 2 METHODS

### 2.1 Data collection

We collected daily online advertisements from one of the most popular Australian classifieds websites, which was identified as a prominent pet trade platform in the online trade snapshot of Toomes et al. ([2023](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0073)), using an automated web scraper (Stringham et al., [2020](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0064)). We focused on the pet bird and herpetofauna (reptile & amphibian) subsections of the website and examined a sample of advertisements (because the total number of advertisements was too numerous to manually examine). For birds, we focused on a 5-month period from 6 July 2019 to 6 December 2019, resulting in 66,704 unique advertisements collected. We examined a uniform random sample of 25% of the bird advertisements (*n* = 16,509). For herpetofauna (reptiles and amphibians), we focused on a one-year time period from 7 July 2019 to 6 July 2020, resulting in 25,132 advertisements. We examined a uniform random sample of 50% of the herpetofauna advertisements (*n* = 12,659). All advertisements collected were publicly viewable and we performed data collection via web scrapers (of advertised titles, descriptions, and images) following ethical standards approved by the University of Adelaide (approval number: H-2020-184). We kept the name of the classifieds website anonymous as this is considered good ethical practice (Stringham et al., [2021](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0065)).

For each advertisement, we used the text description and pictures provided to identify the taxa being traded to the most specific taxonomic level possible (i.e., species, genus, and family). We standardized taxonomic names using the Global Biodiversity Information Facility (GBIF hereafter; GBIF, [2022](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0025)). We disregarded advertisements not trading wildlife (e.g., bird cages, reptile tanks) and advertisements where a user was requesting a certain species (i.e., “wanted” advertisements). Further, since distribution information is provided at the species level, we only considered advertisements where we could identify the taxon traded at the species or subspecies level for our analysis. We excluded advertisements of live animals that do not have any part of their native range within Australia (i.e., alien species). Finally, we considered multiple taxa being traded in one advertisement as their own advertisement (i.e., taxon–advertisement combinations). These filtering steps resulted in a total of 12,317 advertisements.

We recorded the location of each advertisement, provided as the Australian suburb name, and matched it with a spatial dataset of state suburbs from the Australian Bureau of Statistics ([2016](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0001)). Advertisements without suburb location data (*n* = 307; 2.5%) were excluded from our analysis, leaving 12,010 remaining.

We collected species' spatial distribution information from BirdLife International for bird distributions (BirdLife International and Handbook of the Birds of the World, [2017](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0003)), the International Union for Conservation of Nature (IUCN) for amphibian distributions (IUCN, [2018](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0035)), and from Roll et al. ([2017](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0060)) for reptile distributions. For each species, we only considered the native distribution polygons (i.e., we ignored alien ranges, if present). We standardized species names from the spatial distributions to GBIF in order to match with the species names from the online advertisements (see Appendix [S1](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#support-information-section) for more details on name standardization).

### 2.2 Out of range (OOR) trade

For each advertisement, we compared the location of the advertisement to the spatial polygon of the species' native distribution. To account for inaccuracies and uncertainties of the species distribution, we buffered each species' native distribution (by 200 km for birds and 100 km for herpetofauna, broadly reflective of differing dispersal capabilities). This buffered distribution was compared to the centroid of the suburb to which the species was advertised. If the suburb was outside of the native distribution (i.e., did not spatially intersect), then we considered this advertisement to be an OOR trade event for the species. We counted the number of advertisements outside and inside the native distribution to calculate the proportion of listings that were OOR and performed summary analyses and visualization for OOR trade.

### 2.3 Out of range environmental suitability

We assessed the potential for a species to establish non-native OOR populations by implementing range bagging environmental suitability models (Drake, [2015](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0015)), based on the common statistical machine learning approach of bootstrap aggregation or “bagging” (Hastie et al., [2009](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0030)) for creating reliable statistical estimators from ensemble models. Range bagging estimates the multidimensional environmental envelope of a species by creating bootstrap samples of presence data and using these to generate convex low-dimensional shapes (“hulls”) over a subset of bioclimatic variables that captures the range of values experienced by the species across its native and alien range. This approach has proven useful for modeling species' suitable environments in an invasion context (Cope et al., [2019](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0011); Dyer et al., [2016](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0017)). Range bagging is a presence-only method that can be readily applied to existing global occurrence datasets and does not require gathering absence data or generating pseudo-absences, and its predictive performance is similar to other commonly used environmental suitability models such as maximum entropy (Maxent) (Drake, [2015](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0015)). We followed good practices for modeling environmental suitability for alien species by including occurrences in both the native and alien ranges to account for potential niche shifts in the invaded range (Elith, [2017](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0020); Pili et al., [2020](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0054)). For the bioclimatic variables, we used WorldClim global climate data, which consisted of 19 global bioclimatic variables at a 5 arc-minute resolution (Fick & Hijmans, [2017](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0022)). We conducted a principal component analysis on these variables and used the top six principal components, which accounted for 96.8% of the total variance in the dataset, in our range-bagging models.

To summarize our overall approach in implementing range bagging, we (i) obtained species occurrence (i.e., presence) records; (ii) tuned the range bagging model; and (iii) used the tuned model to project species' environmental suitability to all of Australia. For the first component of the analysis, we obtained occurrence records from GBIF ([2022](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0025)), as alien populations are also recorded, allowing us to capture species' environmental tolerances as accurately as possible (see Appendix [S2](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#support-information-section) for details). Next, we tuned the range bagging model using  *N* -fold spatial cross validation (using k-means clustering algorithm; Silge & Mahoney, [2023](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0063)). We varied the number of votes ( *v* ; the number of bootstrapped samples, ranging from 200 to 2000 by increments of 200) and the proportion of records in the sample ( *p* ; ranging from 0.1 to 1 by increments of 0.1). In each model iteration, a single variable (i.e., one of the top six principal components) was included. This resulted in 100 sets of model parameters that were each tested using  *N* -fold spatial cross-validation (for each species). For the  *N* -fold cross-validation, we used 10-folds if the number of occurrences of a species was ≥1000 and fivefold if the number of occurrences was fewer than 1000. For each fold, we split the data (i.e., six principal components at each occurrence point) into training and testing sets with a ratio of 80:20 and 90:10 for 5-fold and 10-fold scenarios, respectively. We used the range bagging algorithm on the training set and then used that resultant model to predict the test set, resulting in  *N* -folds of predictions for each occurrence point. We chose the set of model parameters with the highest macro-average proportion of correctly predicted environmental suitability. Next, we ran the range bagging algorithm with the highest-performing set of parameters on the entire dataset (i.e., all occurrences). We used this model to predict the species climatic suitability to all of Australia. We considered pixels with over 80% suitability scores to represent suitable regions, using a conservative approach with a high suitability threshold, to avoid overestimation of establishment risk (Cope et al., [2019](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0011)). This procedure was repeated for each species we found to be traded outside of their native range.

### 2.4 Identifying high risk species

To assess risk, we determined both whether a species had suitable regions outside of its current range and whether this suitable environment was in close proximity to pet keepers and/or traders. Thus, a species had to meet the following three criteria to be identified as high risk: (a) has climatically suitable regions outside of its native range (determined from the range bagging procedure outlined above); (b) the climatically suitable regions are within at least one state where we detected online trade; and (c) the OOR suitable regions are within 50 km of a suburb that trades wildlife (i.e., all suburbs with records trading any pets found in this study). We chose a 50 km distance within a suburb because we considered this a reasonable distance that a person releasing a pet, or an escaped pet itself, could travel. We excluded suitable pixels that occurred inside of the species' native distribution (buffered by 200 km for birds and 100 km for herpetofauna) to create a distinction between the continuation of a native range and a new potential alien range. For each species, we recorded the Australian states that met the above-outlined criteria. We ran the range bagging models exclusively for species with advertisements outside of their native range (*n* = 129 species), and we did not consider species with fewer than 100 GBIF occurrences (*n* = 34 species; Appendix [S3](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#support-information-section)). We used maps to visualize each species' predicted suitability, native range, and states that met the above-mentioned criteria. We also summarized the number of species, per state, that met these criteria.

All analyses were performed in the R software for statistical and graphical computing (version 4.1.0) (R Core Team, [2022](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0057)) using the following packages: *CoordinateCleaner* (Zizka et al., [2019](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0083)), *flextable* (Gohel & Skintzos, [2024](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0028)), *glue* (Hester & Bryan, [2022](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0032)), *officer* (Gohel & Moog, [2024](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0027)), *patchwork* (Pedersen, [2022](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0053)), *raster* (Hijmans, [2024](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0033)), *rgbif* (Chamberlain et al., [2024](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0008)), *RStoolbox* (Leutner et al., [2022](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0038)), *scales* (Wickham & Seidel, [2022](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0080)), *sf* (Pebesma, [2018](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0051)), *stars* (Pebesma & Bivand, [2023](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0052)), *taxize* (Chamberlain & Szocs, [2013](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0009)), and *tidyverse* (Wickham et al., [2019](https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.13298#csp213298-bib-0079)).
